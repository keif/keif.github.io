---
const { id, user } = Astro.props
const res = await fetch(`https://gist.github.com/${user}/${id}.json`)
const { div, stylesheet } = await res.json()
---

<div class="not-prose gist-embed">
    <link rel="stylesheet" href={stylesheet} />
    <div class="gist-container" set:html={div} />
    <p style="font-size: 0.875em; color: #666; margin-top: 0.5rem;">
        <em>
            Note: This embedded Gist contains the most up-to-date version of the script, which may differ slightly from
            the explanation.
        </em>
    </p>
</div>

<style is:global>
    /* Keep gist box within layout and prevent typography plugin or theme from overriding it */
    .app-prose .gist-embed .gist {
        max-width: 100%;
        overflow: auto;
    }

    .app-prose .gist-embed .gist .file {
        margin: 0 !important;
    }

    /* Kill host table borders/padding that leak into gist tables */
    .app-prose .gist-embed table,
    .app-prose .gist-embed table td,
    .app-prose .gist-embed table th {
        border: 0 !important;
        border-color: transparent !important;
        box-shadow: none !important;
        padding: 1 10 !important; /* let GitHub gist CSS handle spacing */
    }
    .app-prose .gist-embed table td,
    .app-prose .gist-embed table th {
        box-sizing: content-box !important;
    }
    .app-prose .gist-embed table td:first-child,
    .app-prose .gist-embed table th:first-child {
        border-right: 1px solid #e5e7eb !important;
    }
    /* Be explicit for common GitHub gist cells */
    .app-prose .gist-embed .blob-num,
    .app-prose .gist-embed .blob-code,
    .app-prose .gist-embed .blob-code-inner {
        border: 0 !important;
        box-shadow: none !important;
    }
</style>
