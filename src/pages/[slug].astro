---
export async function getStaticPaths() {
  const posts = Object.values(import.meta.glob(['../data/blog/*.md', '../data/blog/*.mdx'], { eager: true }));
  const aliasPaths = posts.flatMap((post: any) => {
    const canonicalSlug = post.frontmatter.slug;
    const aliases = post.frontmatter.aliases || [];
    return aliases.map((alias: string) => ({
      params: { slug: alias },
      props: { canonicalSlug },
    }));
  });

  console.log(`Total posts: ${posts.length}`);
  console.log('frontmatters:', posts.map(p => p.frontmatter));
  console.log(`Total alias paths: ${aliasPaths.length}`);
  console.log("Alias paths:", aliasPaths.map(p => p.params.slug));

  return aliasPaths;
}

const { canonicalSlug } = Astro.props;
---

<html>
  <head>
    <meta http-equiv="refresh" content={`0; url=/posts/${canonicalSlug}`} />
    <link rel="canonical" href={`/posts/${canonicalSlug}`} />
  </head>
  <body>
    Redirecting to <a href={`/posts/${canonicalSlug}`}>{canonicalSlug}</a>â€¦
  </body>
</html>